---
title: '클릭할 때 컨테이너의 가로 사이즈 축소 및 사이드 화면 배치'
excerpt: '20210426 작업일지'
toc: true
toc_sticky: true
toc_label: 'On this page'

categories:
  - workLog
tags:
  - 구현
last_modified_at: 2020-04-26T08:06:00-05:00
---

#### 상황 :

소셜 미디어에 올라온 피드들을 모아서 한번에 볼 수 있게 하였다.
이제 사진을 클릭하면 사진들을 감싸는 컨테이너의 가로 길이가 줄어들면서 옆에 모바일 형식의 화면이 배치되도록 만들어야 한다.

<br>

#### 해결 :

1. 사진을 클릭을 하면 setShowClicked(true)가 되면서 show 라는 클래스가 붙도록 만들었다. show가 붙으면 컨테이너의 가로 길이를 grid-template-columns를 통해 변경시키고, 모바일 화면인 div가 등장한다.
2. 컨테이너 길이는 유동적이기 때문에 컨테이너와 컨테이너를 감싸는 부모의 넓이는 width:100% 로 지정해야한다.
3. 사진을 클릭하면 그에 해당하는 데이터들이 사이드 모바일 화면에 나타나야한다. 따라서 setPost를 이용해서 클릭한 사진에 대한 정보를 Post에 담는다.

<br>

#### 아쉬운 점 :

사진 외의 다른 영역을 클릭하면 클래스 show가 떼지면서 다시 원래대로 돌아와야하는데 계속 이 부분에서 막힌다. window에 onclick을 했을 때 사진이 아닐 때는 setShowClicked(false)로 했는데 왜 안 되는지 모르겠다. 그냥 x 버튼을 만들어서 닫게 했을 때는 setShowClicked(false)가 잘만 동작하는데 왜 그러는걸까? 내일은 수정되어야 할텐데

```js
(...)

const StyledImage = styled.div`
  .sideDisplay {
    width: 400px;
    max-height: 600px;
    position: fixed;
    bottom: 150px;
    right: 100px;
    display: none;
    overflow-y: auto;
    padding: 5px;
    border-radius: 10px;
    box-shadow: 0 3px 6px -4px rgb(0 0 0 / 12%), 0 6px 16px 0 rgb(0 0 0 / 8%),
      0 9px 28px 8px rgb(0 0 0 / 5%);
    transition: all 0.35s ease-in;
    background: #fff;

    ::-webkit-scrollbar {
      bottom: 0;
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background-color: transparent;
      border-radius: 6px;
    }
    ::-webkit-scrollbar-thumb {
      border-radius: 6px;
      background-color: transparent;
      background-clip: padding-box;
      border: 1px solid transparent;
    }
    &:hover::-webkit-scrollbar-thumb {
      background-color: rgba(0, 0, 0, 0.1);
    }

    .imgSizeHandler {
      padding: 10px;
      img {
        width: 100%;
        object-fit: cover;
        cursor: pointer;
      }
    }

    .contents {
      padding: 10px;

      .likes {
        margin-left: 4px;
        margin-right: 10px;
      }
      .comments {
        margin-left: 4px;
      }

      .text {
        margin: 15px 0;
      }
    }
  }

  .sideDisplay.show {
    display: block;
  }

  .showHideWrapper {
    display: grid;
    grid-template-columns: repeat(9, 1fr);
    grid-gap: 15px;

    .postItem {
      position: relative;

      .crown-icon {
        position: absolute;
        top: 5px;
        left: 5px;
        font-size: 18px;
        color: #ffda4f;
      }

      .instagramImg {
        width: 130px;
        height: 130px;
        cursor: pointer;
      }
    }

    .imgWrapper {
      .instagramImg {
        width: 130px;
        height: 130px;
        cursor: pointer;
      }
    }
  }
  .showHideWrapper.show {
    grid-template-columns: repeat(7, 1fr);
  }
`;

function GetInstagramAllImg(popular, recent) {
  const [Post, setPost] = useState([]); // 클릭한 사진의 상태를 담기
  const [ShowClicked, setShowClicked] = useState(false);

  const modalEl = useRef();

  const handleCloseModal = (e) => {
    if (
      ShowClicked &&
      (!modalEl.current || !modalEl.current.contains(e.target))
    )
      setShowClicked(false);
  };

  useEffect(() => {
    window.addEventListener('click', handleCloseModal);
    return () => {
      window.removeEventListener('click', handleCloseModal);
    };
  }, []);

  return (
    <StyledImage>
      <div className={'showHideWrapper' + (ShowClicked ? ' show' : '')}>
        {popular.popular &&
          popular.popular.map((post, index) => {
            return (
              <>
                <div className='postItem' ref={modalEl}>
                  <CrownFilled className='crown-icon' />
                  <img
                    src={post.displayUrl}
                    key={post.key}
                    className='instagramImg'
                    onClick={() => {
                      setShowClicked(true);
                      setPost(post);
                    }}
                  />
                </div>
              </>
            );
          })}
        {popular.recent &&
          popular.recent.map((post, index) => {
            return (
              <>
                <div className='imgWrapper' ref={modalEl}>
                  <img
                    src={post.displayUrl}
                    key={post.key}
                    className='instagramImg'
                    onClick={() => {
                      setShowClicked(true);
                      setPost(post);
                    }}
                  />
                </div>
              </>
            );
          })}
      </div>

      {ShowClicked && (
        <div
          ref={modalEl}
          className={'sideDisplay' + (ShowClicked ? ' show' : '')}
        >
          <div className='imgSizeHandler'>
            {Post.thumbnailUrl ? (
              <img
                src={Post.thumbnailUrl}
                onClick={() => {
                  window.open(Post.redirectUrl, '_blank');
                }}
              />
            ) : null}
          </div>
          <div className='contents'>
            <LikeOutlined />
            {Post.likes ? (
              <span className='likes'>{Post.likes.count}</span>
            ) : (
              <span className='likes'>0</span>
            )}
            <CommentOutlined />
            {Post.comments ? (
              <span className='comments'>{Post.comments.count}</span>
            ) : (
              <span className='comments'>0</span>
            )}
            {Post.text ? <div className='text'>{Post.text}</div> : null}
          </div>
        </div>
      )}
    </StyledImage>
  );
}

export default GetInstagramAllImg;
```
